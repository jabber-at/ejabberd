Description: remove make targets for deps
 Without this patch, dependencies would be downloaded and compiled
 using rebar at build time.
Author: Philipp Huebner <debalance@debian.org>

--- a/Makefile.in
+++ b/Makefile.in
@@ -77,26 +77,11 @@
   INIT_USER=$(INSTALLUSER)
 endif
 
-all: deps src
+all: src
 
-deps: deps/.got
-
-deps/.got:
-	rm -rf deps/.got
-	rm -rf deps/.built
-	$(REBAR) get-deps && :> deps/.got
-
-deps/.built: deps/.got
-	$(REBAR) compile && :> deps/.built
-
-src: deps/.built
+src:
 	$(REBAR) skip_deps=true compile
 
-update:
-	rm -rf deps/.got
-	rm -rf deps/.built
-	$(REBAR) update-deps && :> deps/.got
-
 xref: all
 	$(REBAR) skip_deps=true xref
 
@@ -161,20 +146,12 @@
 	# Administration script
 	[ -d $(SBINDIR) ] || $(INSTALL) -d -m 755 $(SBINDIR)
 	$(INSTALL) -m 550 $(G_USER) ejabberdctl.example $(SBINDIR)/ejabberdctl
-	# Elixir binaries
-	[ -d $(BINDIR) ] || $(INSTALL) -d -m 755 $(BINDIR)
-	[ -f deps/elixir/bin/iex ] && $(INSTALL) -m 550 $(G_USER) deps/elixir/bin/iex $(BINDIR)/iex || true
-	[ -f deps/elixir/bin/elixir ] && $(INSTALL) -m 550 $(G_USER) deps/elixir/bin/elixir $(BINDIR)/elixir || true
-	[ -f deps/elixir/bin/mix ] && $(INSTALL) -m 550 $(G_USER) deps/elixir/bin/mix $(BINDIR)/mix || true
 	#
 	# Init script
 	$(SED) -e "s*@ctlscriptpath@*$(SBINDIR)*" \
 		-e "s*@installuser@*$(INIT_USER)*" ejabberd.init.template \
 		> ejabberd.init
 	chmod 755 ejabberd.init
-	# Install Elixir and Elixir dependancies
-	-$(INSTALL) -m 644 deps/*/lib/*/ebin/*.app $(BEAMDIR)
-	-$(INSTALL) -m 644 deps/*/lib/*/ebin/*.beam $(BEAMDIR)
 	rm -f $(BEAMDIR)/configure.beam
 	#
 	# Binary C programs
@@ -239,8 +216,6 @@
 	rm -rf $(LOGDIR)
 
 clean:
-	rm -rf deps/.got
-	rm -rf deps/.built
 	rm -rf test/*.beam
 	$(REBAR) clean
 
@@ -251,7 +226,6 @@
 	rm -f config.status
 	rm -f config.log
 	rm -rf autom4te.cache
-	rm -rf deps
 	rm -rf ebin
 	rm -f Makefile
 	rm -f vars.config
