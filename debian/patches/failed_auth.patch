diff --git a/src/ejabberd_c2s.erl b/src/ejabberd_c2s.erl
index c762fc0..18c1e75 100644
--- a/src/ejabberd_c2s.erl
+++ b/src/ejabberd_c2s.erl
@@ -688,6 +688,11 @@ wait_for_auth({xmlstreamelement, El}, StateData) ->
 		      ejabberd_hooks:run(c2s_auth_result, StateData#state.server,
 					 [false, U, StateData#state.server,
 					  StateData#state.ip]),
+		      ejabberd_hooks:run(failed_auth_hook,
+				       StateData#state.server,
+				       [legacy, U,
+					StateData#state.server,
+					StateData#state.ip]),
 		      Err = jlib:make_error_reply(El, ?ERR_NOT_AUTHORIZED),
 		      send_element(StateData, Err),
 		      fsm_next_state(wait_for_auth, StateData)
@@ -791,6 +796,11 @@ wait_for_feature_request({xmlstreamelement, El},
 		ejabberd_hooks:run(c2s_auth_result, StateData#state.server,
 				   [false, Username, StateData#state.server,
 				    StateData#state.ip]),
+		ejabberd_hooks:run(failed_auth_hook,
+				   StateData#state.server,
+				   [sasl_auth, Username,
+				    StateData#state.server,
+				    StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
@@ -969,6 +979,11 @@ wait_for_sasl_response({xmlstreamelement, El},
 		ejabberd_hooks:run(c2s_auth_result, StateData#state.server,
 				   [false, Username, StateData#state.server,
 				    StateData#state.ip]),
+		ejabberd_hooks:run(failed_auth_hook,
+			       StateData#state.server,
+			       [sasl_resp, Username,
+				StateData#state.server,
+				StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
@@ -977,6 +992,12 @@ wait_for_sasl_response({xmlstreamelement, El},
 						children = []}]}),
 		fsm_next_state(wait_for_feature_request, StateData);
 	    {error, Error} ->
+		Username = element(5, element(9, StateData#state.sasl_state)),
+		ejabberd_hooks:run(failed_auth_hook,
+			       StateData#state.server,
+			       [sasl_resp, Username,
+				StateData#state.server,
+				StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
