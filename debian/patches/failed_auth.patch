--- a/src/ejabberd_c2s.erl
+++ b/src/ejabberd_c2s.erl
@@ -684,6 +684,11 @@
 		      ejabberd_hooks:run(c2s_auth_result, StateData#state.server,
 					 [false, U, StateData#state.server,
 					  StateData#state.ip]),
+		      ejabberd_hooks:run(failed_auth_hook,
+				       StateData#state.server,
+				       [legacy, U,
+					StateData#state.server,
+					StateData#state.ip]),
 		      Err = jlib:make_error_reply(El, ?ERR_NOT_AUTHORIZED),
 		      send_element(StateData, Err),
 		      fsm_next_state(wait_for_auth, StateData)
@@ -787,6 +792,11 @@
 		ejabberd_hooks:run(c2s_auth_result, StateData#state.server,
 				   [false, Username, StateData#state.server,
 				    StateData#state.ip]),
+		ejabberd_hooks:run(failed_auth_hook,
+				   StateData#state.server,
+				   [sasl_auth, Username,
+				    StateData#state.server,
+				    StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
@@ -965,6 +975,11 @@
 		ejabberd_hooks:run(c2s_auth_result, StateData#state.server,
 				   [false, Username, StateData#state.server,
 				    StateData#state.ip]),
+		ejabberd_hooks:run(failed_auth_hook,
+			       StateData#state.server,
+			       [sasl_resp, Username,
+				StateData#state.server,
+				StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
@@ -973,6 +988,12 @@
 						children = []}]}),
 		fsm_next_state(wait_for_feature_request, StateData);
 	    {error, Error} ->
+		Username = element(5, element(9, StateData#state.sasl_state)),
+		ejabberd_hooks:run(failed_auth_hook,
+			       StateData#state.server,
+			       [sasl_resp, Username,
+				StateData#state.server,
+				StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
