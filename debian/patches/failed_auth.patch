--- a/src/ejabberd_c2s.erl
+++ b/src/ejabberd_c2s.erl
@@ -681,6 +681,11 @@
 				    StateData#state.ip]),
 			    Lang = StateData#state.lang,
 			    Txt = <<"Legacy authentication failed">>,
+                ejabberd_hooks:run(failed_auth_hook,
+                         StateData#state.server,
+                         [legacy, U,
+                     StateData#state.server,
+                     StateData#state.ip]),
 			    Err = jlib:make_error_reply(
 				    El, ?ERRT_NOT_AUTHORIZED(Lang, Txt)),
 			    send_element(StateData, Err),
@@ -786,6 +791,11 @@
 		ejabberd_hooks:run(c2s_auth_result, StateData#state.server,
 				   [false, Username, StateData#state.server,
 				    StateData#state.ip]),
+		ejabberd_hooks:run(failed_auth_hook,
+				   StateData#state.server,
+				   [sasl_auth, Username,
+				    StateData#state.server,
+				    StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
@@ -929,6 +939,11 @@
 		ejabberd_hooks:run(c2s_auth_result, StateData#state.server,
 				   [false, Username, StateData#state.server,
 				    StateData#state.ip]),
+		ejabberd_hooks:run(failed_auth_hook,
+			       StateData#state.server,
+			       [sasl_resp, Username,
+				StateData#state.server,
+				StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
@@ -937,6 +952,12 @@
 						children = []}]}),
 		fsm_next_state(wait_for_feature_request, StateData);
 	    {error, Error} ->
+		Username = element(5, element(9, StateData#state.sasl_state)),
+		ejabberd_hooks:run(failed_auth_hook,
+			       StateData#state.server,
+			       [sasl_resp, Username,
+				StateData#state.server,
+				StateData#state.ip]),
 		send_element(StateData,
 			     #xmlel{name = <<"failure">>,
 				    attrs = [{<<"xmlns">>, ?NS_SASL}],
