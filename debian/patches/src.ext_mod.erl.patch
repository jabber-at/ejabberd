Description: search for include files in /usr/lib/erlang/lib
 The erlang-p1-xml package installs xml.hrl into a directory such as
 </usr/lib/erlang/lib/p1_xml-0.2015.06.15/include>.
 This patch makes sure that all .hrl files in /usr/lib/erlang/lib
 are found and considered/used.
Author: Holger Weiss <holger@zedat.fu-berlin.de>

--- a/src/ext_mod.erl
+++ b/src/ext_mod.erl
@@ -520,11 +520,11 @@
     filelib:ensure_dir(filename:join(Ebin, ".")),
     EjabBin = filename:dirname(code:which(ejabberd)),
     EjabInc = filename:join(filename:dirname(EjabBin), "include"),
-    XmlHrl = filename:join(EjabInc, "fxml.hrl"),
-    ExtLib = [{d, 'NO_EXT_LIB'} || filelib:is_file(XmlHrl)],
-    Options = [{outdir, Ebin}, {i, "include"}, {i, EjabInc},
-               verbose, report_errors, report_warnings]
-              ++ ExtLib,
+    ExtIncs = filelib:wildcard("/usr/lib/erlang/lib/*/include"),
+    IncOpts = [{i, "include"}, {i, EjabInc} | [{i, Dir} || Dir <- ExtIncs]],
+    Options = [{outdir, Ebin} | IncOpts]
+              ++ [verbose, report_errors, report_warnings]
+              ++ [{d, 'NO_EXT_LIB'}],
     [file:copy(App, Ebin) || App <- filelib:wildcard("src/*.app")],
 
     %% Compile erlang files
